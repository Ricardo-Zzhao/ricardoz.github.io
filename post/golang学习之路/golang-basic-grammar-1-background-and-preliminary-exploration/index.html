<!doctype html><html lang=zh-cn dir=content/zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>Golang语法基础1-背景与初探 - 书藏的博客</title><meta name=keywords content="博客,程序员,区块链，思考,读书,笔记,生活,电影,旅游,"><meta name=author content="书藏"><meta property="og:title" content="Golang语法基础1-背景与初探"><meta property="og:site_name" content="书藏的博客"><meta property="og:image" content="/img/author.jpg"><meta name=title content="Golang语法基础1-背景与初探 - 书藏的博客"><meta name=description content="书藏的个人博客，记录学习的东西，以月刊记录生活"><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><link href=//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.css rel=stylesheet><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/syntax.css rel=stylesheet type=text/css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-209130979-1"></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-209130979-1 ');</script></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span><span class=toggle-line></span><span class=toggle-line></span></div></div><div class=site-meta><div class=multi-lang-switch><i class="fa fa-fw fa-language" style=margin-right:5px></i><a class=lang-link id=zh-cn href=#>中文</a></div><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span><span class=site-title>书藏的博客</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>凡心所向，素履以往</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class=menu-item><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class=menu-item><a href=/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于我</a></li><li class=menu-item><a href=/404.html rel=section><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span><span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://shuzang.github.io/post/golang%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/golang-basic-grammar-1-background-and-preliminary-exploration/ itemprop=url>Golang语法基础1-背景与初探</a></h1><div class=post-meta><span class=post-time><i class="fa fa-calendar-o fa-fw"></i><span class=post-meta-item-text>时间：</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2019-09-13">2019-09-13</time></span>
<span class=post-category>&nbsp; | &nbsp;
<i class="fa fa-folder-o fa-fw"></i><span class=post-meta-item-text>分类：</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/categories/golang%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF itemprop=url rel=index style=text-decoration:underline><span itemprop=name>Golang学习之路</span></a>
&nbsp;</span></span>
<span>|
<i class="fa fa-file-word-o fa-fw"></i><span class=post-meta-item-text>字数：</span>
<span class=leancloud-world-count>5776 字</span></span>
<span>|
<i class="fa fa-eye fa-fw"></i><span class=post-meta-item-text>阅读：</span>
<span class=leancloud-view-count>12分钟</span></span>
<span id=/post/golang%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/golang-basic-grammar-1-background-and-preliminary-exploration/ class=leancloud_visitors data-flag-title=Golang语法基础1-背景与初探>|
<i class="fa fa-binoculars fa-fw"></i><span class=post-meta-item-text>阅读次数：</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><h2 id=1-起源与发展>1. 起源与发展</h2><p>Go/Golang 起源于2007年，并于2009年正式对外发布，是一个完全开源的项目，背后的支持者是谷歌公司，核心设计者是三位著名IT工程师：Ken Thompson，Rob Pike，Robert Griesemer。分别是如下从左到右三位</p><p><img src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190913_3AxHPJ.jpg alt=Go语言核心设计者></p><p>其中 Ken Thompson 是 Unix 操作系统的设计者，并因此获得图灵奖，也是C语言前身B语言的设计者，UTF-8 编码设计者之一，计算机史的重要人物，2006年加入谷歌，和另外两人一起设计了Go语言。 Rob Pike 是 Ken 的老搭档。</p><p>随后又有 lan Lance Taylor 和 Russ Cox 两人加入团队，前者是 gccgo 编译器的作者和 cgo工具链的维护者，后者加入团队后着手Go语言标准库的开发。下图分别是他们两个</p><p><img src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190913_3AxT54.jpg alt=Go语言核心开发者></p><p>Go语言以囊地鼠(Gopher)为图标和吉祥物，这是一种原产于加拿大的啮齿类动物，Go语言开发者也一般自称为 Gopher。下图中左边是囊地鼠，右边是 Go logo.</p><p><img src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190913_3AxXKx.jpg alt=Gopher></p><p>Go语言相比于其它语言的最大优势在于它的执行性能与开发效率，这得益于Go在并发编程、内存回收等许多方面的良好设计，并因此大规模用于服务器编程、网络编程、数据库和云平台领域。</p><p>比较出名的Go语言项目有(不限于这些)</p><ul><li>Go语言本身： <a href=https://github.com/golang/go>https://github.com/golang/go</a></li><li>Docker： <a href=https://www.docker.com/>https://www.docker.com/</a></li><li>kubernetes： <a href=https://github.com/kubernetes/kubernetes>https://github.com/kubernetes/kubernetes</a></li><li>Ethereum： <a href=https://github.com/ethereum/go-ethereum>https://github.com/ethereum/go-ethereum</a></li><li>fabric： <a href=https://github.com/hyperledger/fabric>https://github.com/hyperledger/fabric</a></li><li>Hugo： <a href=https://github.com/gohugoio/hugo>https://github.com/gohugoio/hugo</a></li><li>TiDB： <a href=https://github.com/pingcap/tidb>https://github.com/pingcap/tidb</a></li><li>InfluxDB： <a href=https://github.com/influxdata/influxdb>https://github.com/influxdata/influxdb</a></li><li>ETCD： <a href=https://github.com/etcd-io/etcd>https://github.com/etcd-io/etcd</a></li></ul><p>使用Go的国外公司有：Google, Docker, NetFlix, CloudFlare, Dropbox, MongoDB, Uber等</p><p>使用Go的国内公司有：七牛、字节跳动、bilibili、京东、<a href=https://github.com/baidu/bfe>百度</a>，其它公司如小米、腾讯、阿里等也都在使用Go，但可能不是主力</p><h2 id=2-跟踪最新动态>2. 跟踪最新动态</h2><p>最直接的方式是跟踪Go语言的源码库，关注提交历史和<a href=https://github.com/golang/go/issues>issue</a></p><ol><li>原始代码库： <a href=https://go.googlesource.com/go>https://go.googlesource.com/go</a></li><li>github镜像： <a href=https://github.com/golang/go>https://github.com/golang/go</a></li></ol><p>其它活跃论坛或动态</p><ul><li><a href=https://groups.google.com/forum/#!forum/golang-dev>golang-dev</a>：Google邮件列表的Go开发组讨论区</li><li><a href=https://groups.google.com/forum/#!forum/golang-nuts>golang-nuts</a>：Google邮件列表的Go讨论社区</li><li><a href=https://groups.google.com/forum/#!forum/golang-announce>golang-announce</a>：发布Go版本或Go开发的最新状态</li><li><a href=https://go.dev/>go.dev</a>：刚刚上线(2019.11.14)的Go开发人员中心</li><li><a href=https://changelog.com/gotime>gotime</a>：Go的一个播客，每周一更，内容有干货</li><li><a href=https://twitter.com/golang>@golang</a>：Go 语言在 Twitter 的官方帐号</li></ul><p>此外还有每年举办的几个大会</p><ul><li><a href=https://www.gophercon.com/>Gopher Con</a>，举办地在美国，时间不定，今年在7月，2020年会在6月份举行。<a href=https://github.com/gophercon>会议总结</a></li><li><a href=https://gopherchina.org/>GopherChina</a>，举办地在中国，每年4月份。<a href=https://github.com/gopherchina/conference>会议总结</a></li><li><a href=https://www.dotgo.eu/>dotGo</a>，举办地在欧洲，每年3月份</li><li>详细的会议列表可查看 <a href=https://github.com/golang/go/wiki/Conferences>https://github.com/golang/go/wiki/Conferences</a></li></ul><p>Go 下载地址和相关的文档、标准库等访问地址为</p><ul><li>官网 <a href=https://golang.org/>https://golang.org/</a></li><li>国内的镜像网站 <a href=https://golang.google.cn/>https://golang.google.cn/</a></li></ul><p><a href=https://studygolang.com/>Go语言中文网</a> 是国内最活跃的Go社区，每周会发行一份<a href=https://studygolang.com/go/weekly>Go语言爱好者周刊</a></p><p>Go相关资料聚集最多的还是<a href=https://github.com/golang/go/wiki/Articles>go wiki</a></p><h2 id=3-下载安装>3. 下载安装</h2><p>Windowns下快速安装可以使用 chocolatey ，执行如下命令即可</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; choco install golang
</code></pre></div><p>自动配置环境变量，安装完重启终端即可使用。下面开始介绍常规的安装方法，以win10和Ubuntu为例。</p><h3 id=31-下载>3.1 下载</h3><p>Golang中国官网下载页面为 <a href=https://golang.google.cn/dl/>golang.google.cn/dl</a>，为windows，macOS和Linux三种环境都提供了安装包。</p><p><img src=https://picped-1301226557.cos.ap-beijing.myqcloud.com/Go_20190913_Golang%E4%B8%8B%E8%BD%BD%E9%A1%B5%E9%9D%A2.png alt=Golang下载页面></p><p>windows默认下载文件为<code>go1.14.windows-amd64.msi</code>，双击启动即可安装，默认安装位置为<code>C:\Go</code>，环境变量将自动设置。但如果下载了以<code>.zip</code>为后缀的版本，则需要自己解压到合适的路径，并自己设置环境变量。</p><p>Linux默认下载文件为<code>go1.14.linux-amd64.tar.gz</code>，将其解压缩到<code>/usr/local</code>，然后手动将<code>/usr/local/go/bin</code>添加到 PATH 环境变量中。</p><h3 id=32-安装>3.2 安装</h3><h4 id=windows>windows</h4><p><code>msi</code>后缀的安装版本双击安装，环境变量将会自动设置，打开powershell，使用<code>go env</code>命令查看环境变量</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; go env
<span style=color:#a2f>set </span>GO111MODULE=
<span style=color:#a2f>set </span>GOARCH=amd64
<span style=color:#a2f>set </span>GOBIN=
<span style=color:#a2f>set </span>GOCACHE=C:\Users\lylw1\AppData\Local\go-build
<span style=color:#a2f>set </span>GOENV=C:\Users\lylw1\AppData\Roaming\go\env
<span style=color:#a2f>set </span>GOEXE=.exe
<span style=color:#a2f>set </span>GOFLAGS=
<span style=color:#a2f>set </span>GOHOSTARCH=amd64
<span style=color:#a2f>set </span>GOHOSTOS=windows
<span style=color:#a2f>set </span>GOINSECURE=
<span style=color:#a2f>set </span>GONOPROXY=
<span style=color:#a2f>set </span>GONOSUMDB=
<span style=color:#a2f>set </span>GOOS=windows
<span style=color:#a2f>set </span>GOPATH=C:\Users\lylw1\go
<span style=color:#a2f>set </span>GOPRIVATE=
<span style=color:#a2f>set </span>GOPROXY=https<span>:</span>//goproxy.cn,direct
<span style=color:#a2f>set </span>GOROOT=c:\go
<span style=color:#a2f>set </span>GOSUMDB=sum.golang.org
<span style=color:#a2f>set </span>GOTMPDIR=
<span style=color:#a2f>set </span>GOTOOLDIR=c:\go\pkg\tool\windows_amd64
<span style=color:#a2f>set </span>GCCGO=gccgo
<span style=color:#a2f>set </span>AR=ar
<span style=color:#a2f>set </span>CC=gcc
<span style=color:#a2f>set </span>CXX=g++
<span style=color:#a2f>set </span>CGO_ENABLED=1
<span style=color:#a2f>set </span>GOMOD=
<span style=color:#a2f>set </span>CGO_CFLAGS=-g -O2
<span style=color:#a2f>set </span>CGO_CPPFLAGS=
<span style=color:#a2f>set </span>CGO_CXXFLAGS=-g -O2
<span style=color:#a2f>set </span>CGO_FFLAGS=-g -O2
<span style=color:#a2f>set </span>CGO_LDFLAGS=-g -O2
<span style=color:#a2f>set </span>PKG_CONFIG=pkg-config
<span style=color:#a2f>set </span>GOGCCFLAGS=-m64 -mthreads -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=C:\Users\lylw1\AppData\Local\Temp\go-build192094374=/tmp/go-build -gno-record-gcc-switches
</code></pre></div><p>使用 <code>go version</code> 查看版本同时验证安装</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go>&gt; <span style=color:#a2f;font-weight:700>go</span> version
<span style=color:#a2f;font-weight:700>go</span> version go1<span style=color:#666>.13</span><span style=color:#666>.4</span> windows<span style=color:#666>/</span>amd64
</code></pre></div><h4 id=linux>Linux</h4><p>以Ubuntu 20.04 LTS 为例说明，首先在 <a href=https://golang.org/dl/>golang.org/dl</a> 页面右击要下载的版本获取下载链接，使用wget下载文件。也可以直接下载。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ wget https://dl.google.com/go/go1.14.linux-amd64.tar.gz
</code></pre></div><p>将文件解压缩到指定目录/usr/local，<code>-C</code>参数用于指定目标文件夹，解压缩后删除压缩文件。</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ sudo tar -xzf go1.14.linux-amd64.tar.gz -C /usr/local
$ rm go1.14.linux-amd64.tar.gz
</code></pre></div><p>查看安装目录</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ ls /usr/local
bin  etc  games  go  include  lib  man  sbin  share  src
$ ls /usr/local/go
AUTHORS          CONTRIBUTORS  PATENTS    SECURITY.md  api  doc          lib   pkg         src
CONTRIBUTING.md  LICENSE       README.md  VERSION      bin  favicon.ico  misc  robots.txt  <span style=color:#a2f>test</span>
</code></pre></div><p>设置环境变量</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ sudo nano /etc/profile
<span style=color:#080;font-style:italic># 在打开的文件末尾添加下列语句</span>
<span style=color:#a2f>export</span> <span style=color:#b8860b>PATH</span><span style=color:#666>=</span><span style=color:#b8860b>$PATH</span>:/usr/local/go/bin
</code></pre></div><p>更新的环境变量可以通过下面的命令使其直接生效</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ <span style=color:#a2f>source</span> /etc/profile
<span style=color:#080;font-style:italic># 查看生效后的环境变量设置</span>
$ go version
go version go1.14 linux/amd64
</code></pre></div><p>Linux 全部环境变量如下</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go env
<span style=color:#b8860b>GO111MODULE</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
<span style=color:#b8860b>GOBIN</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOCACHE</span><span style=color:#666>=</span><span style=color:#b44>&#34;/home/shuzang/.cache/go-build&#34;</span>
<span style=color:#b8860b>GOENV</span><span style=color:#666>=</span><span style=color:#b44>&#34;/home/shuzang/.config/go/env&#34;</span>
<span style=color:#b8860b>GOEXE</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOHOSTARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
<span style=color:#b8860b>GOHOSTOS</span><span style=color:#666>=</span><span style=color:#b44>&#34;linux&#34;</span>
<span style=color:#b8860b>GOINSECURE</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GONOPROXY</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GONOSUMDB</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOOS</span><span style=color:#666>=</span><span style=color:#b44>&#34;linux&#34;</span>
<span style=color:#b8860b>GOPATH</span><span style=color:#666>=</span><span style=color:#b44>&#34;/home/shuzang/go&#34;</span>
<span style=color:#b8860b>GOPRIVATE</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOPROXY</span><span style=color:#666>=</span><span style=color:#b44>&#34;https://proxy.golang.org,direct&#34;</span>
<span style=color:#b8860b>GOROOT</span><span style=color:#666>=</span><span style=color:#b44>&#34;/usr/local/go&#34;</span>
<span style=color:#b8860b>GOSUMDB</span><span style=color:#666>=</span><span style=color:#b44>&#34;sum.golang.org&#34;</span>
<span style=color:#b8860b>GOTMPDIR</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>GOTOOLDIR</span><span style=color:#666>=</span><span style=color:#b44>&#34;/usr/local/go/pkg/tool/linux_amd64&#34;</span>
<span style=color:#b8860b>GCCGO</span><span style=color:#666>=</span><span style=color:#b44>&#34;gccgo&#34;</span>
<span style=color:#b8860b>AR</span><span style=color:#666>=</span><span style=color:#b44>&#34;ar&#34;</span>
<span style=color:#b8860b>CC</span><span style=color:#666>=</span><span style=color:#b44>&#34;gcc&#34;</span>
<span style=color:#b8860b>CXX</span><span style=color:#666>=</span><span style=color:#b44>&#34;g++&#34;</span>
<span style=color:#b8860b>CGO_ENABLED</span><span style=color:#666>=</span><span style=color:#b44>&#34;1&#34;</span>
<span style=color:#b8860b>GOMOD</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>CGO_CFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;-g -O2&#34;</span>
<span style=color:#b8860b>CGO_CPPFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;&#34;</span>
<span style=color:#b8860b>CGO_CXXFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;-g -O2&#34;</span>
<span style=color:#b8860b>CGO_FFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;-g -O2&#34;</span>
<span style=color:#b8860b>CGO_LDFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;-g -O2&#34;</span>
<span style=color:#b8860b>PKG_CONFIG</span><span style=color:#666>=</span><span style=color:#b44>&#34;pkg-config&#34;</span>
<span style=color:#b8860b>GOGCCFLAGS</span><span style=color:#666>=</span><span style=color:#b44>&#34;-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build153919612=/tmp/go-build -gno-record-gcc-switches&#34;</span>
</code></pre></div><p>注：将环境变量添加到/etc/profile可使go全局启用，也可添加到$HOME/.profile，对当前登录用户起作用。</p><p><em>注：可以使用apt-get命令安装，但安装的go不会是最新版本，同样，也可以使用snap安装，可以安装最新版本。</em></p><h3 id=33-环境变量说明>3.3 环境变量说明</h3><p>常规的使用除了GOPATH外无需关心其它环境变量，但在进行交叉编译时，需要进行一定的设置，详细的环境变量说明可以查看 <a href=https://golang.org/doc/install/source#gopath>$GOPATH environment variable set correctly</a>，以下解释几个主要的环境变量。</p><ul><li><code>GOOS</code>与<code>GOARCH</code>：目标操作系统和处理器架构，</li><li><code>GOHOSTOS</code>和<code>GOHOSTARCH</code>是宿主机操作系统和处理器架构。</li><li><code>GOBIN</code>：编译器和链接器的安装位置，默认是<code>$GOROOT/bin</code>，一般将其设置为空值，Go会使用默认值。</li><li><code>GOROOT</code>：电脑上安装的Go的根目录，Linux下一般为<code>$HOME/go</code>，windows下为<code>C:\go</code></li><li><code>GOPATH</code>：go install、go get等命令默认路径都是<code>GOPATH</code>，是编译后二进制文件的存放目的地、下载后包的存放路径以及 import 包时的搜索路径</li></ul><p>我们需要关心的唯一一个环境变量是GOPATH，可以看到，默认的GOPATH是<code>c:\Users\lylw1\go</code>，其中<code>lylw1</code>是自己的用户名。</p><p>GOPATH 所代表的路径是 go 的工作区，可以选择任意自己喜欢的文件夹作为go的工作区，如果不想使用默认的路径，需要自己进行修改，使用 <code>go env</code> 命令</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>&gt; go env -w GOPATH=/somewhere/<span style=color:#a2f;font-weight:700>else</span>
</code></pre></div><p>更多的环境变量修改方式可以查看<a href=https://github.com/golang/go/wiki/SettingGOPATH#windows>Setting GOPATH</a>，需要注意的一点是GOPATH不能设置为Go的安装目录<code>C:\go</code></p><h3 id=34-安装目录清单>3.4 安装目录清单</h3><p>安装完成的Go根目录（$GOROOT）文件夹结构除了README.md，AUTHORS，LICENSE等常规文件外，基本结构应如下所示：</p><ul><li><code>/bin</code>：包含可执行文件，如：编译器，Go 工具</li><li><code>/doc</code>：包含示例程序，代码工具，本地文档等</li><li><code>/lib</code>：包含文档模版</li><li><code>/misc</code>：包含与支持 Go 编辑器有关的配置文件以及 cgo 的示例</li><li><code>/pkg/os_arch</code>：包含标准库的包的对象文件（<code>.a</code>）</li><li><code>/src</code>：包含源代码构建脚本和标准库的包的完整源代码（Go 是一门开源语言）</li><li><code>/src/cmd</code>：包含 Go 和 C 的编译器和命令行脚本</li></ul><p>这是之前的介绍，网上搜到的多是这个说明，但当前还多了<code>api</code>和<code>test</code>两个文件夹。</p><h3 id=35-代码目录结构>3.5 代码目录结构</h3><p>Go 1.13之前，所有代码在一个工作区，Go 1.13及之后，使用 Go module 进行管理，项目代码不再必须放到 GOPATH 下。本文假设使用 Go 1.13 及以后的版本。对于之前的方式不再介绍。</p><p>Go 程序以包（package）的形式进行组织，一个包就是一个目录，该目录下可能有一个或多个源文件，同一个包的所有代码会被一起编译。另外，同一个包中定义的变量、常量、类型、函数，即使在不同的源文件中，也可以相互访问。</p><p>Go 项目以模块的方式进行组织，模块（module）是一组相关包的集合。一个项目通常是一个仓库（repository），而一个 Go 仓库（repository）只能包含一个模块，但可导入使用多个其它模块，仓库根目录下的 <code>go.mod</code> 文件用来声明这些导入模块的路径。和 <code>go.mod</code> 文件一起位于仓库根目录的是一个一个的子目录，每个子目录可能是一个包，也可能是一个子模块，是否为子模块要看子目录下是否存在 <code>go.mod</code> 文件。</p><p>值得注意的是，尽管项目代码以仓库的方式进行组织，但在编写完成构建之前，代码不需要上传到云端，模块可以本地存在，仓库形式仅仅是因为我们总有一天会将代码上传到云的。</p><p>模块的路径不仅作为导入路径，同样也说明了模块的下载路径，比如 <code>golang.org/x/tools</code>， Go 命令将知道从 <code>https://golang.org/x/tools</code> 去下载它。包的导入路径是模块路径 + 包名，比如，模块 <code>github.com/google/go-cmp</code> 包含一个包（子目录）<code>cmp</code>，这个包的导入路径就是 <code>github.com/google.go-cmp/cmp</code>。Go 的标准库导入不需要模块路径前缀，可以仅使用包名。</p><p>最后，所有的模块都会下载到 GOPATH 的 <code>pkg/mod</code> 目录下，并被所有项目共享，因此，模块代码是只读的。</p><p>本部分说明可以阅读第二篇文章后再来看。</p><h2 id=4-第一个程序>4. 第一个程序</h2><p>编辑并运行我们的第一个程序，按照编程界的惯例，输出<code>hello, world!</code>。</p><p>首先创建项目文件夹并初始化模块，模块路径自行选择</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ mkdir hello
$ <span style=color:#a2f>cd</span> hello
$ go mod init example.com/user/hello
go: creating new go.mod: module example.com/user/hello
$ cat go.mod
module example.com/user/hello

go 1.14
$
</code></pre></div><p>然后在该目录下创建<code>hello.go</code>文件，使其包含如下代码</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a2f;font-weight:700>package</span> main

<span style=color:#a2f;font-weight:700>import</span> <span style=color:#b44>&#34;fmt&#34;</span>

<span style=color:#a2f;font-weight:700>func</span> <span style=color:#00a000>main</span>() {
	fmt.<span style=color:#00a000>Println</span>(<span style=color:#b44>&#34;Hello, world.&#34;</span>)
}
</code></pre></div><p>使用<code>go install</code>命令编译安装</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>&gt; go install github.com/shuzang/hello
</code></pre></div><p>该命令会编译程序并产生一个二进制包，然后将该二进制包安装到 <code>$HOME/go/bin/hello</code> ，如果是 Windows，会安装到 <code>%USERPROFILE%\go\bin\hello.exe</code>。</p><p>安装目录受 GOPATH 和 GOBIN 影响，如果 GOBIN 被设置，则二进制包会被安装到设置的目录，如果 GOPATH 被设置，二进制包将按照到 GOPATH 列表的第一个目录的 bin 子目录，如果都没有被设置，就会安装到默认 GOPATH 的 bin 子目录(<code>$HOME/go</code> or <code>%USERPROFILE%\go</code>)。</p><p><code>go install</code> 命令执行需要在仓库根目录下，且下面三个命令是等效的</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go install example.com/user/hello
$ go install .
$ go install
</code></pre></div><p>将<code>$GOPATH/bin</code>添加到电脑的<code>PATH</code>环境变量中，这样可以直接执行</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>$ hello
Hello, world!
</code></pre></div><p>可能是因为我使用chocolatey安装的原因，这一环境变量也已经自动设好了，所以我可以直接执行命令。</p><p>完成编辑后，就可以使用版本控制工具初始化仓库并上传代码了，示例如下（这一步不是必须的）</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>$ git init
Initialized empty Git repository <span style=color:#a2f;font-weight:700>in</span> C:/Users/lylw1/go/src/github.com/shuzang/hello/.git/
$ git add go.mod hello.go
$ git commit -m <span style=color:#b44>&#34;</span><span style=color:#b44>initial commit</span><span style=color:#b44>&#34;</span>
[master (root-commit) 0b4507d] initial commit
 1 file changed, 7 insertion(+)
 create mode 100644 go.mod hello.go
</code></pre></div><p>一种最方便的方式是将模块路径与仓库路径匹配，比如将以上模块声明为 <code>github.com/username/hello</code>，多数版本控制服务商都支持这种格式。</p><h2 id=5-编辑器ide>5. 编辑器/IDE</h2><p>Golang 开发最流行的两个工具是 Goland 和 VScode，我自己是 VScode 的使用者。除了这两个工具外，官方还提供了一份<a href=https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins>IDE和插件列表</a>。</p><p>VScode 中的 Go 扩展提供了大量的特性，如自动补全、悬停信息显示、括号匹配等，原本属于第三方开发者维护，现在交给了 Go 团队。详细的特性说明查看<a href=https://code.visualstudio.com/docs/languages/go>官网</a>，下面进行一些简单介绍。</p><h3 id=51-go工具链>5.1 Go工具链</h3><p>微软在开发 VS Code 过程中, 定义了一种协议： <a href="https://link.zhihu.com/?target=https%3A//microsoft.github.io/language-server-protocol/">语言服务器协议</a> ，用来为每种语言提供诸如自动完成，代码提示等功能。gopls 就是Go语言的服务器, 安装命令为</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ go get -v golang.org/x/tools/gopls
</code></pre></div><p>事实上，编辑 Go 代码时如果没有安装，VScode 会在右下角弹出提示，只要直接点击 <code>Install</code> 即可，不需要自己输入命令。同时，因为没有设置go.toolsGopath，默认使用了 GOPATH 作为安装路径</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go.toolsGopath setting is not set. Using GOPATH C:<span style=color:#b62;font-weight:700>\U</span>sers<span style=color:#b62;font-weight:700>\l</span>ylw1<span style=color:#b62;font-weight:700>\g</span>o
Installing <span style=color:#666>1</span> tool at C:<span style=color:#b62;font-weight:700>\U</span>sers<span style=color:#b62;font-weight:700>\l</span>ylw1<span style=color:#b62;font-weight:700>\g</span>o<span style=color:#b62;font-weight:700>\b</span>in in module mode.
  gopls

Installing golang.org/x/tools/gopls SUCCEEDED

Reload VS Code window to use the Go language server
All tools successfully installed. You<span>&#39;</span>re ready to Go :<span style=color:#666>)</span>.

</code></pre></div><p>Go代码的调试需要 delve 工具</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span>$</span> <span style=color:#a2f;font-weight:700>go</span> get <span style=color:#666>-</span>v github.com<span style=color:#666>/</span><span style=color:#a2f;font-weight:700>go</span><span style=color:#666>-</span>delve<span style=color:#666>/</span>delve<span style=color:#666>/</span>cmd<span style=color:#666>/</span>dlv
</code></pre></div><p>除此之外，还有一批需要安装的分析工具，如下</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#080;font-style:italic># Below tools are needed for the basic features of the Go extension.</span>
gocode
gopkgs
go-outline
gocode-gomod
godef
goreturns
</code></pre></div><p>所有这些工具只需要在右下角弹出提示后点击 <code>Install</code> 即可</p><p><del>不过上述提到的很多插件不翻墙都无法下载，可以自己手动到github下载然后解压到<code>GOPATH/src</code>，建立起对应的目录结构，然后运行<code>go install</code>将其安装</del></p><p>微软设置了默认的代理服务器，现在(2020.03.18)所有插件均可在不翻墙的情况下顺利安装，而且速度很快</p><h3 id=52-用户和工作区设置>5.2 用户和工作区设置</h3><p>使用 VScode 需要关心的一个重要部分是用户和工作区设置，几乎所有的事情都和它们有关。</p><p><img src=https://code.visualstudio.com/assets/docs/getstarted/settings/hero.png alt></p><p>这是两种不同的设置范围</p><ul><li>用户设置：是一个全局的设置，适用于打开的任何VScode窗口</li><li>工作区设置：如题，项目工作区的设置，只适用于对应的工作区</li></ul><p>工作区的设置会覆盖掉用户设置，它针对具体的项目，配置文件位于项目根目录<code>.vscode</code>文件夹，可与其它开发者共享。<code>.vscode</code>文件夹还用于存放调试配置和任务配置。</p><p>点击左下角的齿轮，选择<code>设置</code>，默认的设置界面如上，是一个可视化的界面，不过也可以使用<code>settings.json</code>配置文件</p><ul><li>用户设置文件在windows中位于<code>%APPDATA%\Code\User\settings.json</code></li><li>工作区设置文件位于根目录的<code>.vscode</code>文件夹中</li></ul><p>最后，VScode大量的操作都可以通过命令完成，使用快捷键<code>Ctrl+Shift+P</code>可以打开命令输入框。</p><h3 id=53-特性说明>5.3 特性说明</h3><p>在用户或工作区设置中，将 <code>go.autocompleteUnimportedPackages</code> 设为<code>true</code> ，可以在代码中点击包名跳转查看包的具体内容。</p><p>鼠标悬停在变量、函数和结构体的名称上方可以查看它们的签名等信息，这一功能由前面安装的<code>godef</code>工具实现，同样可完成这一功能的工具还有<code>godoc</code>和<code>gogetdoc</code>，通过在用户或工作区设置中调整<code>go.docsTool</code>来切换工具。</p><p>代码导航功能无需设置默认实现。</p><p>对源码的保存操作会自动触发格式化、编译和代码质量检查。格式化工具为<code>gofmt</code>，可选的替代工具有<code>goreturns</code>和<code>goimports</code>，在用户或工作区设置中调整<code>go.formatTool</code>来设置。编译的过程使用<code>go build</code>命令。代码质量检查的工具为<code>golint</code>，也可以使用<code>gometalinter</code>，用来检查代码的规范性，检查得到的<code>errors</code>和<code>warning</code>会在编辑器里以红色/绿色波浪线标出来，下面的输出窗口也会显示详细信息。</p><p>所有可选的替代工具都需要自己安装，使用快捷键打开命令面板，输入 <code>Go: Install/Update Tools </code>，选择要安装的工具，点击确定即可。</p><h3 id=54-使用>5.4 使用</h3><p><strong>调试</strong>使用的是前面安装的<code>delve</code>工具。在 VScode 中，按<code>F5</code>启动调试，一般情况下使用默认的调试配置即可，不过还是应当对调试配置选项有一定的了解。</p><p>默认是没有调试配置文件的，当我们需要进行配置时，输入命令 <code>Debug: Open launch.json </code>，第一次会在工作区根目录的<code>.vscode</code>文件夹中创建<code>launch.json</code>文件，文件中默认的配置信息如下</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
    <span style=color:green;font-weight:700>&#34;version&#34;</span>: <span style=color:#b44>&#34;0.2.0&#34;</span>,
    <span style=color:green;font-weight:700>&#34;configurations&#34;</span>: [
        {
            <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;Launch&#34;</span>,
            <span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;go&#34;</span>,
            <span style=color:green;font-weight:700>&#34;request&#34;</span>: <span style=color:#b44>&#34;launch&#34;</span>,
            <span style=color:green;font-weight:700>&#34;mode&#34;</span>: <span style=color:#b44>&#34;auto&#34;</span>,
            <span style=color:green;font-weight:700>&#34;program&#34;</span>: <span style=color:#b44>&#34;${fileDirname}&#34;</span>,
            <span style=color:green;font-weight:700>&#34;env&#34;</span>: {},
            <span style=color:green;font-weight:700>&#34;args&#34;</span>: []
        }
    ]
}
</code></pre></div><p>可设置的配置属性可查看<a href=https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code>Debugging Go code using VS Code</a>，更多关于VScode中Go调试的相关信息都可查看该文档。</p><p>这里需要注意的是<code>args</code>，调试时程序需要传入的参数数组是该配置参数的值</p><p><strong>运行</strong>程序使用快捷键<code>Ctrl+F5</code>，和调试使用的是同一个配置文件。</p></div><footer class=post-footer><div class=post-tags><a href=/tags/go%e8%af%ad%e6%b3%95 rel=tag title=Go语法>#Go语法#</a></div><div class=addthis_inline_share_toolbox></div><div class=post-nav><div class=article-copyright><div class=article-copyright-img><img src=/img/qq_qrcode.png width=129px height=129px><div style=text-align:center>QQ扫一扫交流</div></div><div class=article-copyright-info><p><span>声明：</span>Golang语法基础1-背景与初探</p><p><span>链接：</span>https://shuzang.github.io/post/golang%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/golang-basic-grammar-1-background-and-preliminary-exploration/</p><p><span>作者：</span>书藏</p><p><span>声明： </span>本博客文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank style=text-decoration:underline>CC BY-NC-SA 3.0</a>许可协议，转载请注明出处！</p></div></div><div class=clear></div></div><div class=reward-qr-info><div>创作实属不易，如有帮助，那就打赏博主些许茶钱吧 ^_^</div><button id=rewardButton disable=enable onclick="var qr=document.getElementById('QR');if(qr.style.display==='none'){qr.style.display='block';}else{qr.style.display='none'}">
<span>赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/img/wechat-pay.png alt="WeChat Pay"><p>微信打赏</p></div><div id=alipay style=display:inline-block><img id=alipay_qr src=/img/ali-pay.png alt=Alipay><p>支付宝打赏</p></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://shuzang.github.io/post/%E6%88%91%E6%89%80%E7%83%AD%E7%88%B1%E7%9A%84%E7%94%9F%E6%B4%BB%E5%95%8A/scaleless-net-light-tower/ rel=next title=白塔、弥陀寺及碧霞宫><i class="fa fa-chevron-left"></i>白塔、弥陀寺及碧霞宫</a></div><div class="post-nav-prev post-nav-item"><a href=https://shuzang.github.io/post/%E7%A0%94%E7%A9%B6%E7%94%9F%E7%9A%84%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/using-virtual-machine-to-build-experimental-platform/ rel=prev title=研究记录4-利用虚拟机搭建实验平台(失败)>研究记录4-利用虚拟机搭建实验平台(失败)
<i class="fa fa-chevron-right"></i></a></div></div><div id=wcomments></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/images/avatar.png alt=书藏><p class=site-author-name itemprop=name>书藏</p><p class="site-description motion-element" itemprop=description></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>334</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>7</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>23</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/shuzang/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>GitHub</a></span></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/tags/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0>论文笔记</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E4%B9%A6%E8%97%8F%E7%9A%84%E7%94%9F%E6%B4%BB%E5%91%A8%E5%88%8A>书藏的生活周刊</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E7%A7%91%E7%A0%94%E8%AE%B0%E5%BD%95>科研记录</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/go%E8%AF%AD%E6%B3%95>Go语法</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80>计算机基础</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E6%9D%82%E8%B0%88>杂谈</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E5%8C%BA%E5%9D%97%E9%93%BE>区块链</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95>数据结构与算法</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/%E7%94%9F%E6%B4%BB%E6%8A%80%E8%83%BD>生活技能</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/go%E5%AE%9E%E6%88%98>Go实战</a></li></ul></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span><span class=copyright-author>书藏的博客</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.63.2</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span class=site-uv><i class="fa fa-user"></i><span class=busuanzi-value id=busuanzi_value_site_uv></span></span><span class=separator-line>/</span>
<span class=site-pv><i class="fa fa-eye"></i><span class=busuanzi-value id=busuanzi_value_site_pv></span></span></div><div class=license-info><span class=storage-info>Storage by
<a href=https://www.ucloud.cn/ style=font-weight:700 target=_blank>UCloud云存储</a></span>
<span class=separator-line>/</span>
<span class=license-num><a href target=_blank></a></span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i><span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script><script type=text/javascript src=/js/search.js></script><script type=text/javascript src=/js/affix.js></script><script type=text/javascript src=/js/scrollspy.js></script><script type=text/javascript>function detectIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf('MSIE ');var trident=ua.indexOf('Trident/');var edge=ua.indexOf('Edge/');if(msie>0||trident>0||edge>0){return-1;}
return 1;}
function getCntViewHeight(){var docHeight=$('#content').height(),winHeight=$(window).height(),cntViewHeight=(docHeight>winHeight)?(docHeight-winHeight):($(document).height()-winHeight);return cntViewHeight;}
function getScrollbarWidth(){var $div=$('<div />').addClass('scrollbar-measure').prependTo('body');var div=$div[0];var scrollbarWidth=div.offsetWidth-div.clientWidth;$div.remove();return scrollbarWidth;}
function registerBackTop(){var THRESHOLD=50;var $top=$('.back-to-top');$(window).on('scroll',function(){$top.toggleClass('back-to-top-on',window.pageYOffset>THRESHOLD);var scrollTop=$(window).scrollTop();var cntViewHeight=getCntViewHeight();var scrollPercent=(scrollTop)/(cntViewHeight);var scrollPercentRounded=Math.round(scrollPercent*100);var scrollPercentMaxed=(scrollPercentRounded>100)?100:scrollPercentRounded;$('#scrollpercent>span').html(scrollPercentMaxed);});$top.on('click',function(){$("html,body").animate({scrollTop:0,screenLeft:0,},800);});}
function initScrollSpy(){var tocSelector='.post-toc';var $tocElement=$(tocSelector);var activeCurrentSelector='.active-current';$tocElement.on('activate.bs.scrollspy',function(){var $currentActiveElement=$(tocSelector+' .active').last();removeCurrentActiveClass();$currentActiveElement.addClass('active-current');}).on('clear.bs.scrollspy',removeCurrentActiveClass);$('body').scrollspy({target:tocSelector});function removeCurrentActiveClass(){$(tocSelector+' '+activeCurrentSelector).removeClass(activeCurrentSelector.substring(1));}}
function initAffix(){var headerHeight=$('.header-inner').height();var footerOffset=parseInt($('.main').css('padding-bottom'),10);var sidebarTop=headerHeight+10;$('.sidebar-inner').affix({offset:{top:sidebarTop,bottom:footerOffset}});$(document).on('affixed.bs.affix',function(){updateTOCHeight(document.body.clientHeight-100);});}
function initTOCDimension(){var updateTOCHeightTimer;$(window).on('resize',function(){updateTOCHeightTimer&&clearTimeout(updateTOCHeightTimer);updateTOCHeightTimer=setTimeout(function(){var tocWrapperHeight=document.body.clientHeight-100;updateTOCHeight(tocWrapperHeight);},0);});updateTOCHeight(document.body.clientHeight-100);var scrollbarWidth=getScrollbarWidth();$('.post-toc').css('width','calc(100% + '+scrollbarWidth+'px)');}
function updateTOCHeight(height){height=height||'auto';$('.post-toc').css('max-height',height);}
$(function(){var sidebarTop=$('.header-inner').height()+10;$('#sidebar').css({'margin-top':sidebarTop}).show();var sidebarMt=parseInt($('#sidebar').css('margin-top'));var sidebarInHeight=parseInt($('.sidebar-inner').css('height'));var sideHeight=sidebarMt+sidebarInHeight;var contentHeight=$('.content-wrap').height();if(contentHeight<sideHeight){$('.content-wrap').css('min-height',sideHeight);}
$('.site-nav-toggle').on('click',function(){var $siteNav=$('.site-nav');var $toggleLine=$('.toggle');var ON_CLASS_NAME='site-nav-on';var CLOSE_CLASS_NAME='toggle-close';var isSiteNavOn=$siteNav.hasClass(ON_CLASS_NAME);var animateAction=isSiteNavOn?'slideUp':'slideDown';var animateCallback=isSiteNavOn?'removeClass':'addClass';$siteNav.stop()[animateAction]('normal',function(){$siteNav[animateCallback](ON_CLASS_NAME);$toggleLine[animateCallback](CLOSE_CLASS_NAME);});});registerBackTop();initScrollSpy();initAffix();initTOCDimension();$('.sidebar-nav-toc').click(function(){$(this).addClass('sidebar-nav-active');$(this).next().removeClass('sidebar-nav-active');$('.'+$(this).next().attr('data-target')).toggle(500);$('.'+$(this).attr('data-target')).toggle(500);});$('.sidebar-nav-overview').click(function(){$(this).addClass('sidebar-nav-active');$(this).prev().removeClass('sidebar-nav-active');$('.'+$(this).prev().attr('data-target')).toggle(500);$('.'+$(this).attr('data-target')).toggle(500);});});</script><script src=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.js></script><script type=text/javascript>$(function(){$('.post-body').viewer();});</script><script type=text/javascript>$(function(){if(detectIE()>0){$.getScript(document.location.protocol+'//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js',function(){new Waline({el:'#wcomments',visitor:true,avatar:'wavatar',avatarCDN:'https://sdn.geekzu.org/avatar/',avatarForce:!1,wordLimit:'200',placeholder:' 欢迎留下您的宝贵建议，请填写您的昵称和邮箱便于后续交流. ^_^ ',requiredFields:['nick','mail'],serverURL:"Your WalineSerURL",lang:"zh-cn"});});}else{$('#wcomments').html('抱歉，Waline插件不支持IE或Edge，建议使用Chrome浏览器。');}});</script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=Your%20AddthisId"></script><script>(function(){var bp=document.createElement('script');var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script></body></html>